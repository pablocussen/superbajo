<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bajo ElÃ©ctrico para Eloisa ðŸ’•</title>
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/lucide/0.263.1/umd/lucide.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @keyframes float {
            0% { transform: translateY(0px) rotate(0deg); opacity: 1; }
            100% { transform: translateY(-100px) rotate(360deg); opacity: 0; }
        }
        @keyframes bounce {
            0%, 20%, 53%, 80%, 100% { transform: translate3d(0, 0, 0); }
            40%, 43% { transform: translate3d(0, -10px, 0); }
            70% { transform: translate3d(0, -5px, 0); }
            90% { transform: translate3d(0, -2px, 0); }
        }
        .float { animation: float 2s ease-out forwards; }
        .bounce { animation: bounce 1s infinite; }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useCallback, useRef } = React;
        const { 
            Music, Volume2, Play, Pause, RotateCcw, Star, 
            Heart, Mic, Trophy, Github, Smartphone 
        } = lucide;

        // Audio Context
        let audioContext;
        let masterGainNode;
        let analyserNode;

        const initAudioContext = () => {
            if (!audioContext) {
                audioContext = new (window.AudioContext || window.webkitAudioContext)();
                masterGainNode = audioContext.createGain();
                analyserNode = audioContext.createAnalyser();
                
                masterGainNode.connect(analyserNode);
                analyserNode.connect(audioContext.destination);
                masterGainNode.gain.value = 0.3;
                
                analyserNode.fftSize = 2048;
            }
            return audioContext;
        };

        const BassGuitarApp = () => {
            const [currentLesson, setCurrentLesson] = useState(0);
            const [isPlaying, setIsPlaying] = useState(false);
            const [score, setScore] = useState(0);
            const [activeString, setActiveString] = useState(null);
            const [showNotes, setShowNotes] = useState(true);
            const [hearts, setHearts] = useState([]);
            const [isListening, setIsListening] = useState(false);
            const [detectedNote, setDetectedNote] = useState('');
            const [streak, setStreak] = useState(0);
            const [achievements, setAchievements] = useState([]);
            const [showPrize, setShowPrize] = useState('');

            const streamRef = useRef(null);
            const animationRef = useRef(null);

            // Notas del bajo
            const bassNotes = {
                1: { note: 'G', freq: 98, color: '#FF6B9D', name: 'Sol' },
                2: { note: 'D', freq: 73.42, color: '#4ECDC4', name: 'Re' },
                3: { note: 'A', freq: 55, color: '#FFE66D', name: 'La' },
                4: { note: 'E', freq: 41.2, color: '#A8E6CF', name: 'Mi' }
            };

            // CanciÃ³n inspirada
            const inspiredSong = [
                { string: 4, duration: 800, note: 'Mi' },
                { string: 3, duration: 800, note: 'La' },
                { string: 2, duration: 800, note: 'Re' },
                { string: 1, duration: 800, note: 'Sol' },
                { string: 4, duration: 400, note: 'Mi' },
                { string: 3, duration: 400, note: 'La' },
                { string: 2, duration: 1200, note: 'Re' },
            ];

            const lessons = [
                {
                    title: "Â¡Conoce tu Bajo! ðŸŽ¸",
                    description: "Haz clic en cada cuerda para escuchar su sonido",
                    target: null,
                    instructions: "Las cuerdas del bajo son: Mi (E), La (A), Re (D), Sol (G)",
                    emoji: "ðŸŽµ"
                },
                {
                    title: "Toca la cuerda Mi (E) ðŸŒŸ",
                    description: "Encuentra y toca la cuerda mÃ¡s gruesa",
                    target: 4,
                    instructions: "La cuerda Mi es la mÃ¡s grave y gruesa del bajo",
                    emoji: "ðŸ’«"
                },
                {
                    title: "Toca la cuerda Sol (G) â­",
                    description: "Encuentra y toca la cuerda mÃ¡s aguda",
                    target: 1,
                    instructions: "La cuerda Sol es la mÃ¡s aguda y delgada del bajo",
                    emoji: "ðŸŒˆ"
                },
                {
                    title: "Practica la progresiÃ³n ðŸŽ¯",
                    description: "Sigue la secuencia: Mi-La-Re-Sol",
                    target: 'sequence',
                    instructions: "Â¡Toca las cuerdas en el orden correcto!",
                    emoji: "ðŸŽŠ"
                }
            ];

            const prizes = [
                "Â¡Estrella Dorada! ðŸŒŸ", "Â¡CorazÃ³n Musical! ðŸ’–", "Â¡Rayo de MÃºsica! âš¡", 
                "Â¡Nota Perfecta! ðŸŽµ", "Â¡Bajo Maestro! ðŸ†", "Â¡ArcoÃ­ris Musical! ðŸŒˆ"
            ];

            const createHearts = useCallback((x, y) => {
                const newHearts = [];
                for (let i = 0; i < 5; i++) {
                    newHearts.push({
                        id: Date.now() + i,
                        x: x + (Math.random() - 0.5) * 100,
                        y: y,
                        emoji: ['ðŸ’–', 'ðŸ’', 'ðŸ’•', 'ðŸ’—', 'ðŸŽµ', 'â­'][Math.floor(Math.random() * 6)]
                    });
                }
                setHearts(prev => [...prev, ...newHearts]);
                setTimeout(() => {
                    setHearts(prev => prev.filter(heart => !newHearts.some(newHeart => newHeart.id === heart.id)));
                }, 2000);
            }, []);

            const showPrizeAnimation = (prize) => {
                setShowPrize(prize);
                setTimeout(() => setShowPrize(''), 3000);
            };

            const playNote = useCallback((stringNum, event) => {
                const ctx = initAudioContext();
                if (ctx.state === 'suspended') {
                    ctx.resume();
                }

                const { freq } = bassNotes[stringNum];
                
                const oscillator = ctx.createOscillator();
                const gainNode = ctx.createGain();
                
                oscillator.connect(gainNode);
                gainNode.connect(masterGainNode);
                
                oscillator.frequency.setValueAtTime(freq, ctx.currentTime);
                oscillator.type = 'sawtooth';
                
                gainNode.gain.setValueAtTime(0, ctx.currentTime);
                gainNode.gain.linearRampToValueAtTime(0.8, ctx.currentTime + 0.01);
                gainNode.gain.exponentialRampToValueAtTime(0.4, ctx.currentTime + 0.1);
                gainNode.gain.exponentialRampToValueAtTime(0.01, ctx.currentTime + 1.5);
                
                oscillator.start(ctx.currentTime);
                oscillator.stop(ctx.currentTime + 1.5);
                
                setActiveString(stringNum);
                setTimeout(() => setActiveString(null), 200);
                
                // Crear corazones
                if (event) {
                    createHearts(event.clientX, event.clientY);
                }
                
                if (lessons[currentLesson].target === stringNum) {
                    setScore(score + 10);
                    setStreak(prev => prev + 1);
                    if (currentLesson < lessons.length - 1) {
                        setTimeout(() => setCurrentLesson(currentLesson + 1), 1000);
                    }
                }
            }, [currentLesson, score, createHearts]);

            const playInspiredSong = () => {
                setIsPlaying(true);
                let index = 0;
                
                const playNext = () => {
                    if (index < inspiredSong.length) {
                        playNote(inspiredSong[index].string);
                        index++;
                        setTimeout(playNext, inspiredSong[index - 1]?.duration || 800);
                    } else {
                        setIsPlaying(false);
                        setScore(prev => prev + 50);
                        showPrizeAnimation("Â¡CanciÃ³n Completada! ðŸŽ‰");
                    }
                };
                
                playNext();
            };

            const startListening = async () => {
                try {
                    const ctx = initAudioContext();
                    const stream = await navigator.mediaDevices.getUserMedia({ audio: true });
                    streamRef.current = stream;
                    
                    const source = ctx.createMediaStreamSource(stream);
                    source.connect(analyserNode);
                    
                    setIsListening(true);
                    alert('ðŸŽ¤ Â¡MicrÃ³fono activado! Toca tu bajo y veamos quÃ© detectamos ðŸŽµ');
                } catch (error) {
                    console.error('Error accessing microphone:', error);
                    alert('No se pudo acceder al micrÃ³fono. AsegÃºrate de dar permisos. ðŸŽ¤');
                }
            };

            const stopListening = () => {
                setIsListening(false);
                if (streamRef.current) {
                    streamRef.current.getTracks().forEach(track => track.stop());
                }
                setDetectedNote('');
            };

            const resetLesson = () => {
                setCurrentLesson(0);
                setScore(0);
                setStreak(0);
                setAchievements([]);
            };

            return React.createElement('div', {
                className: "min-h-screen bg-gradient-to-br from-purple-400 via-pink-300 to-yellow-300 p-4 relative overflow-hidden"
            }, [
                // Floating Hearts
                ...hearts.map(heart => React.createElement('div', {
                    key: heart.id,
                    className: "absolute text-2xl pointer-events-none float",
                    style: {
                        left: heart.x,
                        top: heart.y,
                        zIndex: 1000
                    }
                }, heart.emoji)),

                // Prize Animation
                showPrize && React.createElement('div', {
                    className: "fixed inset-0 flex items-center justify-center z-50 pointer-events-none"
                }, React.createElement('div', {
                    className: "text-6xl font-bold text-yellow-400 animate-pulse bg-purple-900 bg-opacity-75 px-8 py-4 rounded-full shadow-2xl"
                }, showPrize)),

                React.createElement('div', { className: "max-w-4xl mx-auto relative" }, [
                    // Header
                    React.createElement('div', { className: "text-center mb-8" }, [
                        React.createElement('h1', {
                            className: "text-4xl font-bold text-white mb-2 flex items-center justify-center gap-3 flex-wrap"
                        }, [
                            React.createElement(Music, { className: "text-pink-600", size: 40 }),
                            "Bajo ElÃ©ctrico para Eloisa ðŸ’•",
                            React.createElement(Star, { className: "text-yellow-400", size: 40 })
                        ]),
                        React.createElement('p', {
                            className: "text-white text-lg"
                        }, "Â¡Aprende a tocar el bajo de manera sÃºper divertida! ðŸŽ¸"),
                        
                        // GitHub & Mobile Info
                        React.createElement('div', { className: "flex justify-center gap-4 mt-4 flex-wrap" }, [
                            React.createElement('div', {
                                className: "bg-white bg-opacity-20 rounded-full px-4 py-2 flex items-center gap-2"
                            }, [
                                React.createElement(Github, { size: 20, className: "text-white" }),
                                React.createElement('span', {
                                    className: "text-white text-sm"
                                }, "Â¡Compartible en GitHub!")
                            ]),
                            React.createElement('div', {
                                className: "bg-white bg-opacity-20 rounded-full px-4 py-2 flex items-center gap-2"
                            }, [
                                React.createElement(Smartphone, { size: 20, className: "text-white" }),
                                React.createElement('span', {
                                    className: "text-white text-sm"
                                }, "Â¡Funciona en tu celular!")
                            ])
                        ])
                    ]),

                    // Stats
                    React.createElement('div', { className: "flex justify-center gap-4 mb-6 flex-wrap" }, [
                        React.createElement('div', {
                            className: "bg-white rounded-full px-4 py-2 shadow-lg"
                        }, React.createElement('span', {
                            className: "text-purple-600 font-bold"
                        }, `Puntos: ${score} â­`)),
                        
                        React.createElement('div', {
                            className: "bg-white rounded-full px-4 py-2 shadow-lg"
                        }, React.createElement('span', {
                            className: "text-pink-600 font-bold"
                        }, `LecciÃ³n: ${currentLesson + 1}/${lessons.length}`)),
                        
                        React.createElement('div', {
                            className: "bg-white rounded-full px-4 py-2 shadow-lg"
                        }, React.createElement('span', {
                            className: "text-green-600 font-bold"
                        }, `Racha: ${streak} ðŸ”¥`)),
                        
                        detectedNote && React.createElement('div', {
                            className: "bg-yellow-200 rounded-full px-4 py-2 shadow-lg"
                        }, React.createElement('span', {
                            className: "text-yellow-800 font-bold"
                        }, `DetectÃ©: ${detectedNote} ðŸŽµ`))
                    ]),

                    // Lesson Info
                    React.createElement('div', { className: "bg-white rounded-xl p-6 shadow-xl mb-8" }, [
                        React.createElement('h2', {
                            className: "text-2xl font-bold text-gray-800 mb-2"
                        }, lessons[currentLesson].title),
                        React.createElement('p', {
                            className: "text-gray-600 mb-3"
                        }, lessons[currentLesson].description),
                        React.createElement('p', {
                            className: "text-sm text-blue-600 bg-blue-50 p-3 rounded-lg"
                        }, lessons[currentLesson].instructions)
                    ]),

                    // Microphone Control
                    React.createElement('div', { className: "flex justify-center mb-6" }, [
                        React.createElement('button', {
                            onClick: isListening ? stopListening : startListening,
                            className: `${isListening ? 'bg-red-500 hover:bg-red-600' : 'bg-green-500 hover:bg-green-600'} text-white px-6 py-3 rounded-full shadow-lg flex items-center gap-2 font-bold`
                        }, [
                            React.createElement(Mic, { size: 20 }),
                            isListening ? 'ðŸ”´ Parar DetecciÃ³n' : 'ðŸŽ¤ Detectar mi Bajo'
                        ])
                    ]),

                    // Bass Guitar
                    React.createElement('div', { className: "bg-gradient-to-r from-amber-800 to-amber-900 rounded-xl p-8 shadow-2xl mb-8" }, [
                        React.createElement('div', { className: "relative" }, [
                            // Neck
                            React.createElement('div', { className: "bg-amber-700 h-32 rounded-lg relative overflow-hidden" }, [
                                // Frets
                                ...Array.from({length: 5}, (_, i) => 
                                    React.createElement('div', {
                                        key: i,
                                        className: "absolute bg-gray-300 h-full w-1 opacity-30",
                                        style: { left: `${15 + i * 15}%` }
                                    })
                                ),
                                
                                // Strings
                                ...Object.entries(bassNotes).map(([stringNum, noteData]) =>
                                    React.createElement('div', {
                                        key: stringNum,
                                        className: "absolute w-full flex items-center cursor-pointer transform hover:scale-105 transition-all duration-200",
                                        style: { 
                                            top: `${(parseInt(stringNum) - 1) * 25 + 10}%`,
                                            height: '15%'
                                        },
                                        onClick: (e) => playNote(parseInt(stringNum), e)
                                    }, [
                                        // String line
                                        React.createElement('div', {
                                            className: `w-full h-1 transition-all duration-300 ${
                                                activeString === parseInt(stringNum) 
                                                    ? 'shadow-lg transform scale-y-150' 
                                                    : ''
                                            }`,
                                            style: { 
                                                backgroundColor: noteData.color,
                                                height: `${5 - parseInt(stringNum)}px`,
                                                boxShadow: activeString === parseInt(stringNum) 
                                                    ? `0 0 20px ${noteData.color}` 
                                                    : 'none'
                                            }
                                        }),
                                        
                                        // Note label
                                        showNotes && React.createElement('div', {
                                            className: "absolute -left-16 bg-white px-3 py-1 rounded-full shadow-lg text-sm font-bold flex items-center gap-1",
                                            style: { color: noteData.color }
                                        }, [
                                            `${noteData.name} (${noteData.note})`,
                                            detectedNote === noteData.name && React.createElement('span', {
                                                className: "text-green-500"
                                            }, 'âœ“')
                                        ])
                                    ])
                                )
                            ]),
                            
                            // Body
                            React.createElement('div', { className: "bg-red-600 w-32 h-40 rounded-lg shadow-xl mt-4 mx-auto relative" }, [
                                React.createElement('div', { className: "absolute inset-4 bg-red-700 rounded-lg" }),
                                React.createElement('div', { className: "absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2" }, [
                                    React.createElement('div', { className: "w-8 h-8 bg-gray-300 rounded-full shadow-inner flex items-center justify-center" }, [
                                        React.createElement(Heart, { className: "text-red-800", size: 16 })
                                    ])
                                ])
                            ])
                        ])
                    ]),

                    // Controls
                    React.createElement('div', { className: "flex flex-wrap justify-center gap-4 mb-8" }, [
                        React.createElement('button', {
                            onClick: playInspiredSong,
                            disabled: isPlaying,
                            className: "bg-green-500 hover:bg-green-600 text-white px-6 py-3 rounded-full shadow-lg disabled:opacity-50 flex items-center gap-2 font-bold"
                        }, [
                            React.createElement(isPlaying ? Pause : Play, { size: 20 }),
                            isPlaying ? 'Tocando... ðŸŽµ' : 'CanciÃ³n Inspirada ðŸŽ¶'
                        ]),
                        
                        React.createElement('button', {
                            onClick: () => setShowNotes(!showNotes),
                            className: "bg-blue-500 hover:bg-blue-600 text-white px-6 py-3 rounded-full shadow-lg flex items-center gap-2 font-bold"
                        }, [
                            React.createElement(Music, { size: 20 }),
                            (showNotes ? 'Ocultar Notas' : 'Mostrar Notas') + ' ðŸ‘€'
                        ]),
                        
                        React.createElement('button', {
                            onClick: resetLesson,
                            className: "bg-orange-500 hover:bg-orange-600 text-white px-6 py-3 rounded-full shadow-lg flex items-center gap-2 font-bold"
                        }, [
                            React.createElement(RotateCcw, { size: 20 }),
                            'Reiniciar ðŸ”„'
                        ])
                    ]),

                    // Achievements
                    achievements.length > 0 && React.createElement('div', { className: "bg-gradient-to-r from-yellow-200 to-pink-200 rounded-xl p-6 shadow-xl mb-8" }, [
                        React.createElement('h3', {
                            className: "text-xl font-bold text-purple-800 mb-3 flex items-center gap-2"
                        }, [
                            React.createElement(Trophy, { className: "text-yellow-600" }),
                            'Â¡Tus Logros! ðŸ†'
                        ]),
                        React.createElement('div', { className: "flex flex-wrap gap-2" }, 
                            achievements.map((achievement, index) =>
                                React.createElement('span', {
                                    key: index,
                                    className: "bg-white px-3 py-1 rounded-full text-sm font-bold text-purple-600 shadow"
                                }, achievement)
                            )
                        )
                    ]),

                    // Tips
                    React.createElement('div', { className: "bg-yellow-100 rounded-xl p-6 shadow-xl mb-8" }, [
                        React.createElement('h3', {
                            className: "text-xl font-bold text-yellow-800 mb-3"
                        }, "ðŸ’¡ Consejos sÃºper geniales para Eloisa:"),
                        React.createElement('ul', { className: "text-yellow-700 space-y-2" }, [
                            React.createElement('li', {}, "â€¢ ðŸŽ¸ Las cuerdas mÃ¡s gruesas producen sonidos mÃ¡s graves (bajos)"),
                            React.createElement('li', {}, "â€¢ âœ¨ Las cuerdas mÃ¡s delgadas producen sonidos mÃ¡s agudos"),
                            React.createElement('li', {}, "â€¢ ðŸŽµ El bajo es la base rÃ­tmica de la mÃºsica - Â¡eres la estrella!"),
                            React.createElement('li', {}, "â€¢ ðŸŽ¤ Usa el micrÃ³fono para que detecte las notas de tu bajo real"),
                            React.createElement('li', {}, "â€¢ ðŸ’– Cada nota correcta te da corazones y puntos extras"),
                            React.createElement('li', {}, "â€¢ ðŸŒŸ Â¡Practica todos los dÃ­as y serÃ¡s una bajista increÃ­ble!")
                        ])
                    ]),

                    // GitHub Instructions
                    React.createElement('div', { className: "bg-gray-100 rounded-xl p-6 shadow-xl" }, [
                        React.createElement('h3', {
                            className: "text-xl font-bold text-gray-800 mb-3 flex items-center gap-2"
                        }, [
                            React.createElement(Github, { className: "text-gray-600" }),
                            "Para papÃ¡: Instrucciones GitHub ðŸ“±"
                        ]),
                        React.createElement('div', { className: "text-gray-600 space-y-2 text-sm" }, [
                            React.createElement('p', {}, "1. Guarda este archivo como 'index.html'"),
                            React.createElement('p', {}, "2. Crea un repositorio nuevo en GitHub"),
                            React.createElement('p', {}, "3. Sube el archivo index.html"),
                            React.createElement('p', {}, "4. Ve a Settings â†’ Pages â†’ Source: Deploy from branch"),
                            React.createElement('p', {}, "5. Selecciona 'main' branch y 'root' folder"),
                            React.createElement('p', {}, "6. Â¡Listo! La URL aparecerÃ¡ en unos minutos"),
                            React.createElement('p', {}, "7. Â¡Eloisa podrÃ¡ usarla desde cualquier dispositivo! ðŸŽ¸ðŸ’•")
                        ])
                    ])
                ])
            ]);
        };

        ReactDOM.render(React.createElement(BassGuitarApp), document.getElementById('root'));
    </script>
</body>
</html>
